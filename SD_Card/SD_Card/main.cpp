#include <avr/io.h>
#include "timeout.h"
#include <util/delay.h>
#include <string.h>
#include <stdlib.h>
#include "sdcard/ff.h"
#include "sdcard/integer.h"

FATFS FatFs;	// FatFs work area 
FIL *fp;		// fpe object 

/*---------------------------------------------------------*/
/* User Provided RTC Function called by FatFs module       */
/* Used to provide a Timestamp for SDCard files and folders*/
DWORD get_fattime (void)
{
	// Returns current time packed into a DWORD variable 
	return	  ((DWORD)(2013 - 1980) << 25)	// Year 2013 
	| ((DWORD)8 << 21)				// Month 7 
	| ((DWORD)2 << 16)				// Day 28 
	| ((DWORD)20 << 11)				// Hour 0..24
	| ((DWORD)30 << 5)				// Min 0 
	| ((DWORD)0 >> 1);				// Sec/2 0
}


int main(void)
{
	char image[] = {
		0xFF,0xD8,0xFF,0xE0,0x00,0x10,0x4A,0x46,0x49,0x46,
		0x00,0x01,0x01,0x01,0x00,0x60,0x00,0x60,0x00,0x00,
		0xFF,0xDB,0x00,0x84,0x00,0x05,0x03,0x04,0x04,0x04,
		0x03,0x05,0x04,0x04,0x04,0x05,0x05,0x05,0x06,0x07,
		0x0C,0x08,0x07,0x07,0x07,0x07,0x0F,0x0B,0x0B,0x09,
		0x0C,0x11,0x0F,0x12,0x12,0x11,0x0F,0x11,0x11,0x13,
		0x16,0x1C,0x17,0x13,0x14,0x1A,0x15,0x11,0x11,0x18,
		0x21,0x18,0x1A,0x1D,0x1D,0x1F,0x1F,0x1F,0x13,0x17,
		0x22,0x24,0x22,0x1E,0x24,0x1C,0x1E,0x1F,0x1E,0x01,
		0x05,0x05,0x05,0x07,0x06,0x07,0x0E,0x08,0x08,0x0E,
		0x1E,0x14,0x11,0x14,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,
		0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,
		0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,
		0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,
		0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E,
		0x1E,0x1E,0x1E,0x1E,0xFF,0xC2,0x00,0x11,0x08,0x00,
		0x60,0x00,0x60,0x03,0x01,0x22,0x00,0x02,0x11,0x01,
		0x03,0x11,0x01,0xFF,0xC4,0x00,0x33,0x00,0x00,0x02,
		0x03,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x06,0x07,0x04,0x05,0x08,0x03,
		0x00,0x09,0x02,0x01,0x00,0x03,0x01,0x01,0x01,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x03,0x04,0x05,0x02,0x06,0x01,0xFF,0xDA,0x00,0x0C,
		0x03,0x01,0x00,0x02,0x10,0x03,0x10,0x00,0x00,0x00,
		0x15,0xE4,0x03,0x6D,0xCA,0x75,0x0E,0xC2,0xE4,0xBB,
		0xD3,0x7E,0x57,0xD2,0x2F,0x10,0x6E,0xA9,0xA6,0xCB,
		0x72,0x8C,0x83,0x8B,0x62,0x2E,0xC8,0xA3,0x72,0xF7,
		0xAE,0x9A,0x8B,0x06,0x7D,0xC9,0x18,0xC6,0xD1,0xB7,
		0x0A,0xF2,0xEB,0x52,0x28,0xCB,0xB8,0x6E,0xAF,0x6E,
		0x1B,0xDA,0x4A,0x92,0x7F,0x3E,0x29,0xFE,0x86,0x2C,
		0x57,0x36,0x58,0xD3,0x39,0x81,0xB8,0xA1,0xB4,0x0B,
		0x35,0x64,0xCE,0xF4,0x29,0x0E,0xF5,0x6C,0xDB,0x73,
		0x55,0xEA,0xB7,0x75,0x7C,0xEA,0x84,0x65,0x01,0x96,
		0x6B,0xB7,0x70,0x2F,0x59,0x4E,0xAB,0x4B,0xDA,0xD7,
		0x55,0x58,0x32,0x6A,0xCF,0x5B,0x32,0xA8,0xC8,0xC7,
		0x0D,0x3C,0xC6,0x4A,0x6D,0xB8,0x0B,0x96,0x46,0x8B,
		0xB2,0xD9,0x89,0x45,0x27,0x47,0xE2,0x58,0xB7,0xB7,
		0x51,0x98,0xD4,0xF0,0xA9,0x25,0x32,0xC8,0x64,0x2E,
		0x98,0x9D,0x07,0x35,0x89,0xFF,0x00,0x41,0x84,0x00,
		0x78,0xE0,0xD0,0x18,0x23,0xD2,0xB6,0x5D,0x59,0x7E,
		0x29,0xF1,0xA4,0x53,0xEB,0x3F,0x2A,0x73,0x12,0xA4,
		0x83,0xAD,0x36,0x1A,0xAC,0x20,0x03,0xDA,0xB0,0x31,
		0x47,0x61,0xEE,0xDD,0x51,0xE1,0x53,0x74,0xA2,0x62,
		0x56,0x8C,0x6D,0xE6,0xDD,0x29,0xC9,0x58,0xA0,0xCB,
		0x9E,0x08,0x32,0xAC,0xFE,0xC0,0x25,0x97,0xC6,0xDA,
		0xD1,0x38,0xC2,0xF3,0x1A,0xFF,0xC4,0x00,0x2C,0x10,
		0x00,0x01,0x05,0x00,0x01,0x04,0x01,0x04,0x01,0x03,
		0x05,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x02,0x04,
		0x05,0x06,0x07,0x00,0x11,0x12,0x13,0x21,0x08,0x14,
		0x22,0x32,0x15,0x16,0x41,0x42,0x23,0x24,0x25,0x31,
		0x33,0xFF,0xDA,0x00,0x08,0x01,0x01,0x00,0x01,0x0C,
		0x00,0xB4,0xAD,0xB9,0x96,0xBE,0x02,0x70,0x9A,0xCC,
		0xEE,0x7E,0xC6,0x0D,0x93,0x64,0x48,0x23,0x15,0xA1,
		0x9D,0x19,0xEC,0x41,0xFB,0x1B,0xE5,0x55,0x71,0x15,
		0x2B,0x7C,0x1C,0xAE,0x55,0xCF,0xDA,0xC7,0x6B,0x0B,
		0xF8,0x91,0x53,0x61,0xCA,0x99,0xBC,0xF4,0x87,0x44,
		0x3B,0xCA,0x79,0x55,0x1C,0xC7,0x4C,0xC5,0x3C,0xB3,
		0x56,0x4B,0xEF,0x99,0xDA,0x53,0xE8,0x8C,0x58,0xF5,
		0xAA,0x57,0x49,0x83,0xF7,0x43,0x33,0x95,0xF5,0xD2,
		0xFB,0x68,0x86,0xD2,0xDA,0xCD,0x2A,0x31,0xCD,0xEB,
		0x89,0x11,0x12,0xB9,0xC9,0xFD,0xDB,0xFA,0xA7,0x56,
		0x76,0xB6,0xA9,0x2C,0xBE,0x13,0x0E,0xD4,0xC1,0x12,
		0xDA,0x7D,0xD3,0x14,0xF3,0x0C,0xE1,0x47,0x14,0xA8,
		0x5A,0x95,0x73,0x8B,0xE4,0x0C,0xC0,0x80,0xFA,0x94,
		0x23,0x86,0xCE,0xDC,0xC7,0xC9,0xD2,0x68,0xE2,0xCA,
		0xA9,0xA1,0x20,0xD8,0xE7,0xDC,0x98,0xD2,0x55,0xC5,
		0xEE,0x57,0x2D,0xD8,0x84,0x31,0x47,0x45,0x42,0xBE,
		0x2E,0xC9,0x60,0x95,0x25,0xC3,0x57,0x0A,0x5F,0xD3,
		0xD7,0x31,0x47,0xD4,0x7D,0xAE,0x6A,0xFD,0x5A,0x96,
		0x3C,0x8E,0xD5,0x4D,0x3D,0x8B,0x5A,0xDE,0xCB,0xC5,
		0x28,0x9F,0xC7,0xAF,0xC7,0xCB,0x7F,0x54,0xEA,0xC3,
		0x8E,0xEE,0x4A,0x57,0x3D,0x9E,0x23,0x5C,0xEE,0x52,
		0xDE,0xA6,0x5B,0x0C,0x57,0xB1,0x59,0x36,0xBA,0x71,
		0xAF,0x12,0x4B,0x66,0xB1,0xA3,0xE4,0xED,0x99,0x68,
		0xF8,0xF0,0x15,0xB0,0x8F,0xEA,0x93,0x7C,0x74,0x3B,
		0x04,0xC0,0xB9,0x4A,0xB5,0x7C,0x4F,0xB9,0xB0,0x80,
		0xB3,0x47,0x4A,0x51,0x88,0xF8,0xED,0x50,0x25,0xBE,
		0x32,0xD3,0x4B,0xF6,0x4C,0x83,0x36,0x0C,0x9F,0xB6,
		0x9B,0x18,0xA0,0x2D,0x64,0xE9,0xF0,0xEC,0xA0,0x9A,
		0xB0,0xA4,0x09,0x83,0xA7,0x66,0xB6,0x1A,0xDD,0xAB,
		0x3D,0x72,0x38,0xA5,0x7B,0xD7,0xBB,0xA4,0xFD,0x13,
		0xAB,0x05,0x04,0xD0,0x89,0x11,0xAA,0x8D,0x7C,0x10,
		0xB7,0xF2,0xEC,0xBD,0x5A,0x66,0x00,0x69,0x44,0x9B,
		0xEE,0x73,0x57,0x99,0xA5,0xFA,0xCF,0x02,0x2B,0xDC,
		0x8E,0x67,0xD3,0x7F,0x19,0xB2,0x78,0xA3,0xEA,0xAF,
		0x41,0xE6,0x84,0x88,0xD4,0x1A,0x31,0x06,0x88,0x92,
		0xA8,0x62,0x38,0x8A,0x47,0xC7,0x6A,0xBB,0x98,0x30,
		0x30,0x6F,0x2B,0x09,0x21,0x91,0xDA,0xC9,0x48,0x37,
		0x43,0xB5,0x70,0x3C,0xDE,0x3E,0xB8,0x84,0xC4,0x6A,
		0xCF,0x1B,0x95,0x14,0x7C,0x52,0xA8,0xB0,0x9F,0xDB,
		0xA6,0xFE,0xA9,0xD4,0x52,0xB5,0x58,0xD6,0x34,0x8D,
		0x5E,0xA4,0x23,0xBD,0x2A,0xAA,0xBF,0x12,0xBC,0x5F,
		0x15,0xED,0x57,0x78,0x75,0xA4,0xA3,0x6E,0x9B,0x95,
		0xB3,0xB9,0xD7,0x39,0x5C,0x06,0xEA,0xFF,0x00,0xA7,
		0xD1,0x62,0x55,0xE7,0x24,0x4E,0x87,0x91,0xD8,0x41,
		0xD1,0x45,0x42,0x24,0x43,0x44,0x26,0xC7,0x73,0x59,
		0x42,0x05,0x71,0xA1,0xCB,0x94,0xA1,0xDC,0x57,0xDB,
		0x95,0x82,0x3D,0x25,0x84,0x11,0xFD,0x45,0xE0,0xE3,
		0xD4,0x18,0x5A,0x8A,0xB4,0x6B,0x63,0xF1,0x0B,0xBD,
		0xB2,0x2C,0xD1,0x11,0x57,0xAE,0x26,0x4E,0xD5,0xEF,
		0x45,0x45,0x45,0x6F,0xEA,0x9D,0x5F,0x66,0x41,0x02,
		0xD2,0xA9,0xD0,0x25,0x94,0x0E,0x91,0x89,0x85,0xFC,
		0x59,0x5E,0x29,0x44,0x6B,0xF5,0x34,0x40,0x8F,0x9B,
		0x49,0x63,0x3B,0x91,0x70,0xF9,0x58,0x46,0x9B,0x8D,
		0xD4,0x87,0xBA,0xCC,0xDA,0xF1,0xBD,0xA5,0xA4,0xB9,
		0x06,0x6C,0xEB,0x07,0x8F,0x8A,0x30,0x44,0xCB,0x90,
		0x8F,0x90,0x77,0xBF,0xAD,0xD6,0x42,0xD6,0xCE,0xF4,
		0x92,0x84,0x53,0x12,0x36,0x7F,0x1F,0xB9,0x85,0x60,
		0x8F,0x15,0x9C,0xA3,0x44,0xE6,0x7A,0xC9,0x12,0xF8,
		0xB6,0x54,0x22,0x22,0x38,0xF9,0x3C,0x4D,0x66,0x5B,
		0x0F,0x1E,0x40,0x5E,0xC9,0x13,0x38,0xC9,0x3F,0x19,
		0x1D,0xBE,0x13,0xFC,0x53,0xAF,0x5B,0xA2,0x5D,0x8E,
		0x63,0xEE,0x7F,0x18,0x1A,0x99,0x52,0xAA,0xFD,0x02,
		0xB3,0x2B,0xC5,0xA5,0xB2,0x23,0xE9,0xD4,0x52,0x24,
		0x13,0xD7,0xC4,0x6E,0x7A,0x66,0x69,0x88,0xD4,0x45,
		0x0D,0x96,0x89,0xAC,0x1B,0x01,0x19,0x3C,0xE4,0x41,
		0xD1,0x0A,0x29,0x4F,0x16,0x70,0x5E,0x27,0x0F,0x4C,
		0xC9,0x36,0x0D,0x24,0x38,0x92,0x1A,0xD1,0xDA,0xC6,
		0x97,0x0D,0xA5,0x12,0xA2,0xB7,0x91,0x48,0xB2,0x63,
		0x02,0xB8,0x4D,0x42,0x17,0x64,0xA9,0x51,0x5B,0x5F,
		0x56,0xE7,0xA3,0xDF,0xC5,0xAE,0x42,0x42,0x21,0x53,
		0xFE,0xBF,0xC5,0x3A,0xD2,0x21,0x8B,0x38,0xAA,0xD7,
		0xBB,0xAE,0x3B,0xBD,0x97,0x5E,0x71,0x45,0x79,0x15,
		0xCC,0xDC,0xC9,0x47,0x53,0x3B,0xB3,0x93,0xBF,0x12,
		0xCF,0x58,0x18,0xB8,0x07,0x7B,0x97,0xD1,0xAA,0x8D,
		0x61,0x61,0x15,0xB2,0xF3,0x52,0x42,0x09,0xF5,0xD0,
		0x5F,0x2E,0xB0,0x5F,0x7B,0x65,0x25,0x64,0xEB,0x1F,
		0x63,0x58,0x25,0x05,0x09,0x56,0x64,0xFA,0x4F,0xB8,
		0x8F,0x58,0xD9,0x16,0x8A,0x36,0x4B,0xD9,0xDE,0xBA,
		0x11,0x1D,0x61,0x1D,0x5A,0xF3,0xCF,0xB7,0x9D,0x7C,
		0xE4,0xB1,0x9F,0xEB,0xF6,0x71,0x5B,0x3B,0x52,0xB5,
		0x7A,0xFE,0xC9,0xD1,0xA9,0x2A,0x09,0x21,0xE4,0x24,
		0xC6,0xA3,0xAB,0xB3,0x30,0x23,0xD8,0x0A,0x4B,0xA4,
		0xB5,0x12,0xDC,0x35,0x92,0x02,0xE0,0xC8,0x9B,0xE3,
		0xD6,0x31,0xD0,0x63,0xE1,0xCF,0x1C,0xAE,0x6A,0xD6,
		0xF1,0x0F,0x27,0x47,0x65,0xBC,0x7A,0xBB,0x79,0x0F,
		0xFB,0x43,0x45,0x85,0x3D,0xCA,0x68,0xD3,0xC8,0xD5,
		0x9A,0xB0,0x6B,0x84,0xE7,0xCD,0xB3,0x45,0x1E,0x9F,
		0x94,0xDB,0x2C,0xF2,0x09,0x0F,0xC9,0x62,0xC2,0xB8,
		0x35,0x8E,0x9B,0xFA,0x76,0xC0,0x68,0xBD,0x00,0x4D,
		0x0C,0x5F,0x5A,0x27,0xC7,0x16,0x2F,0xFC,0x2A,0x74,
		0xAB,0xF0,0x9D,0x59,0x9C,0x8D,0xB1,0x37,0x65,0xF8,
		0xAF,0xB1,0x35,0x9C,0xC8,0x71,0x80,0xDE,0xFD,0x69,
		0xEA,0x98,0xDA,0xB7,0x1D,0xAD,0xEE,0x5D,0x35,0xFC,
		0xE1,0xE5,0x85,0x9A,0x01,0x95,0xB1,0xF0,0xD9,0xA8,
		0x7B,0x1E,0x23,0xAF,0x01,0x1D,0xE9,0x99,0x18,0xFC,
		0x99,0x96,0x72,0xC0,0x5B,0x32,0x94,0x16,0x2F,0xE4,
		0x4D,0x21,0x5C,0x23,0x3C,0xA4,0x02,0xE7,0xD9,0x99,
		0x8B,0xFC,0xCE,0x8E,0x5A,0x19,0xF5,0x16,0x13,0x52,
		0xC9,0xD7,0x26,0x73,0x9B,0x2A,0x9E,0xCE,0x25,0xA5,
		0x70,0xCC,0xC2,0x0D,0xA6,0xE3,0x26,0xAB,0x69,0x93,
		0xE3,0xA5,0x5F,0x84,0xEA,0x65,0x1D,0x1F,0xBD,0xEF,
		0x34,0x8F,0xF5,0x20,0x48,0x83,0x52,0x2F,0x18,0x0A,
		0x30,0x2E,0xCB,0x5F,0x70,0x53,0xAC,0x70,0x58,0x90,
		0x10,0x63,0xC9,0x75,0x85,0x72,0xCC,0xF2,0x73,0xDD,
		0xF4,0xB6,0xD8,0xD2,0xF2,0x52,0xE1,0x17,0xBA,0xBC,
		0xF9,0x51,0x11,0xAA,0xA8,0x65,0xED,0x77,0x57,0x1A,
		0xAA,0x19,0x4E,0x72,0xB1,0x82,0xD8,0x5D,0x93,0x57,
		0xA6,0x59,0x45,0x33,0x41,0x58,0xDA,0xE4,0x6F,0xE8,
		0xDE,0xED,0xB0,0xFF,0x00,0x6F,0x4E,0x31,0x35,0xAA,
		0xEE,0xB8,0x67,0x92,0x26,0xD3,0x93,0xF8,0xEB,0x97,
		0x12,0x65,0x75,0x0D,0xFD,0x45,0xEC,0x6F,0x7D,0x54,
		0xE1,0x49,0x41,0x4E,0xF6,0x37,0xFF,0x00,0x3F,0x62,
		0xB1,0x54,0x9F,0x3E,0xB5,0x4E,0xB4,0x35,0x52,0xE7,
		0x1D,0x3B,0x78,0xFA,0xCF,0x1A,0x6D,0x3B,0xFC,0xC2,
		0x47,0x35,0x3E,0x98,0xF5,0x71,0xAB,0xB7,0xA2,0x82,
		0x55,0x68,0x05,0xC8,0x9B,0x8C,0xBE,0x22,0xBF,0xEE,
		0x2F,0x6C,0xC6,0x12,0x72,0x4F,0x29,0x69,0x76,0x76,
		0xB2,0x15,0xB2,0x49,0x0A,0xA9,0xE9,0x2A,0x61,0x51,
		0x1E,0x42,0x19,0xF5,0x12,0xF4,0x35,0x08,0x89,0x19,
		0xEE,0x70,0xA1,0x5D,0x1E,0xDA,0x3B,0x02,0x7A,0xE7,
		0xC5,0x2D,0x7B,0x90,0x0E,0xFC,0x9A,0x8E,0x4A,0x4B,
		0xB9,0x34,0xF3,0x07,0x2A,0x0C,0xD2,0x46,0x91,0xFF,
		0xC4,0x00,0x33,0x10,0x00,0x02,0x01,0x03,0x02,0x04,
		0x04,0x04,0x05,0x04,0x03,0x00,0x00,0x00,0x00,0x00,
		0x01,0x02,0x11,0x00,0x03,0x21,0x12,0x31,0x04,0x22,
		0x41,0x51,0x13,0x61,0x71,0x81,0x42,0x91,0xA1,0xB1,
		0x10,0x32,0x52,0xC1,0xF0,0x05,0x23,0x33,0x82,0x62,
		0x72,0xE1,0xFF,0xDA,0x00,0x08,0x01,0x01,0x00,0x0D,
		0x3F,0x00,0xE9,0xCD,0x43,0x78,0x6A,0x1D,0x01,0xCD,
		0x05,0xE8,0xA6,0x8B,0x9D,0x94,0xD2,0x89,0x6B,0x56,
		0xC6,0x57,0xD4,0xF4,0xAB,0x8D,0x85,0x52,0xB3,0x18,
		0xEF,0x19,0xC8,0xC5,0x24,0x93,0x61,0x96,0x1E,0x3B,
		0xC7,0x51,0x46,0x7E,0x0A,0xD5,0xB3,0x08,0x22,0xBC,
		0x43,0x51,0x41,0x8C,0x43,0x50,0xC1,0x0C,0xC6,0x0D,
		0x3E,0xCA,0x7A,0x1A,0x29,0x32,0x47,0x95,0x5C,0xB8,
		0x55,0xAF,0xDB,0x20,0x95,0x00,0x4F,0x29,0x1B,0x19,
		0xFB,0x55,0xC1,0x2E,0xCE,0x77,0x3D,0x7E,0xB5,0x21,
		0x8B,0x0C,0x0C,0x60,0x08,0xF4,0x1F,0x41,0x56,0x6F,
		0x4D,0xAB,0xCA,0xC4,0x30,0x00,0xF7,0x15,0x7D,0x9A,
		0xCF,0x0B,0xC4,0x90,0x22,0xEB,0x05,0xD4,0x15,0xBB,
		0x18,0xC0,0x3D,0x68,0x69,0x91,0xEC,0x2B,0xC4,0x35,
		0x14,0xC6,0x46,0xB3,0xFB,0x50,0x10,0xC1,0x69,0x5A,
		0x74,0x13,0x5C,0x69,0xF0,0x9D,0xC6,0x08,0xB6,0x07,
		0x34,0x1E,0x93,0x81,0x35,0x73,0x1A,0x02,0x1D,0xE7,
		0x6F,0xAD,0x05,0xD4,0xA2,0xE9,0x08,0xCC,0x3C,0x81,
		0xA5,0xEC,0x9F,0xBD,0x0F,0x82,0xE2,0xC1,0xAE,0x16,
		0xE8,0xB8,0xB7,0x14,0xC1,0x57,0x06,0x66,0x9E,0xD2,
		0x27,0x10,0x92,0x0C,0x5C,0x55,0x00,0x91,0x1D,0x0E,
		0xE2,0xBC,0x43,0x51,0x4B,0x90,0x04,0x00,0x3D,0x00,
		0xAF,0x5A,0x06,0x40,0x0C,0x6A,0xD7,0x05,0x36,0xE7,
		0xB9,0x9C,0xFB,0x90,0x3E,0x55,0xAB,0x57,0x07,0x61,
		0x86,0x00,0xFD,0x46,0xA2,0x36,0xA8,0xC1,0x8A,0xB4,
		0xA7,0x4B,0x01,0x92,0x3B,0x52,0x5C,0xD3,0x00,0xF9,
		0xC5,0x3D,0x95,0x7F,0x5C,0xE0,0xFD,0x6B,0xC4,0x3F,
		0x87,0x69,0xA0,0x28,0xF5,0x8A,0xBD,0xA3,0xC6,0x8D,
		0xD9,0x17,0x53,0xB7,0xD0,0x1F,0x9D,0x70,0xEB,0xE1,
		0x81,0x64,0x04,0x2B,0xA7,0x06,0x35,0x10,0x08,0xAE,
		0xB6,0x6F,0xC6,0xA1,0xF2,0xA9,0xD2,0x17,0x87,0xB7,
		0xA9,0xA6,0xAE,0x6E,0xFC,0x42,0x69,0x81,0xDE,0x04,
		0xD5,0xEB,0xA2,0xD7,0x12,0xAA,0x31,0x27,0x66,0x1F,
		0x6A,0x5B,0x36,0xC2,0x0E,0xC0,0xE6,0xBC,0x53,0x22,
		0xA2,0xB8,0x92,0x4D,0xD1,0x76,0xE1,0x65,0xC0,0xC0,
		0x03,0x1D,0xEA,0xD5,0xBD,0x5A,0xD8,0x82,0x1B,0x6C,
		0x9F,0x9F,0x4A,0x6B,0x05,0xDF,0x5C,0x46,0xA0,0x09,
		0xC7,0x96,0x28,0xDB,0xBF,0x62,0xE1,0x99,0x95,0xF0,
		0xEE,0xC1,0xF2,0x20,0xC8,0xF7,0xAB,0xE1,0x42,0x25,
		0xAB,0xE1,0x05,0xA8,0x33,0x81,0x11,0x9E,0xB3,0x34,
		0x2C,0x85,0x08,0xD7,0x35,0xC1,0x02,0x24,0x9E,0xA4,
		0xC4,0x9F,0x33,0x5F,0x98,0x59,0x46,0x89,0xFE,0x6F,
		0x5A,0xA5,0xED,0xF1,0x96,0x83,0x2E,0x98,0x1C,0xA3,
		0x9B,0x1F,0xFB,0x57,0x2E,0xD9,0x51,0xE4,0x75,0x80,
		0x2B,0x89,0xB8,0x8D,0x7A,0xF8,0xF8,0xB7,0x85,0x1D,
		0x80,0x07,0x6A,0xF1,0x7F,0x61,0x51,0x56,0xDB,0x95,
		0x19,0xA4,0x0F,0x6A,0x29,0xA5,0x91,0x5C,0xE9,0x23,
		0xB4,0x50,0x04,0x28,0x66,0x24,0x01,0xE5,0xDA,0xB8,
		0x6B,0xF7,0xED,0xC9,0x12,0x4C,0xA8,0x60,0x7E,0xA6,
		0xAE,0x8E,0x45,0x1D,0xBB,0x9E,0xC2,0x91,0x04,0x5D,
		0x26,0x56,0xE1,0xEB,0x15,0x69,0x88,0xB9,0xAC,0x40,
		0x75,0xF2,0xA3,0xD3,0x62,0x0F,0x62,0x2B,0x88,0xE2,
		0x2D,0x94,0x07,0x60,0x15,0x83,0x19,0xF9,0x52,0xB9,
		0xE2,0x1F,0x4E,0x00,0x19,0x02,0x3C,0xB2,0x7E,0x54,
		0xD7,0x4F,0xE1,0xAB,0xF5,0x53,0x98,0xC9,0xC8,0xA2,
		0x93,0xF4,0xA0,0xE0,0x3C,0x9C,0x0D,0x42,0x01,0xF9,
		0xC0,0xA1,0x09,0xE2,0x5D,0x5D,0x4A,0x14,0x12,0x72,
		0x3D,0xEA,0x00,0xBE,0xB7,0x6C,0x29,0x0A,0xD8,0x98,
		0xEE,0x37,0x8A,0x73,0xCB,0x6E,0xEF,0x0F,0xA6,0xD8,
		0x12,0x24,0xB3,0x03,0x20,0x64,0xED,0x3B,0x55,0xE0,
		0x0B,0xA5,0xB2,0x74,0x4A,0x8C,0x9C,0xFF,0x00,0x30,
		0x2B,0x86,0x50,0xF6,0xC3,0x89,0x50,0x4B,0x05,0x00,
		0xFA,0x89,0x34,0x6D,0xAA,0x85,0xB6,0xB0,0xAA,0xA3,
		0xA0,0xF9,0xD1,0xB8,0x7E,0xF5,0x14,0xC7,0x69,0xA0,
		0xDC,0xBE,0x74,0x13,0x4C,0x4D,0x0B,0x0C,0x2E,0x5D,
		0x67,0xD2,0x15,0x63,0xF3,0x4F,0x48,0xEF,0x5C,0x60,
		0x71,0xC1,0xF1,0x77,0x57,0x48,0xBC,0x15,0xCA,0xAB,
		0x1E,0xDA,0xB4,0xB7,0xB8,0xA1,0xD1,0x18,0x44,0x7A,
		0x52,0xE5,0x8B,0xE9,0x59,0x8E,0xA6,0x05,0x06,0x16,
		0xED,0x62,0x35,0x66,0x24,0x55,0xEE,0x0D,0x38,0xB6,
		0x7D,0x47,0x52,0x5C,0x24,0x85,0x43,0xFE,0xB9,0x1E,
		0xB4,0xA2,0x2B,0xC4,0x3F,0x7F,0xC0,0x39,0xFB,0xD5,
		0xB6,0x1A,0x88,0xA2,0x9F,0x5A,0xB5,0x6C,0x35,0xF0,
		0x86,0x03,0xB7,0x9F,0x71,0x5C,0x13,0x5E,0x4B,0x17,
		0xD3,0xF3,0x21,0xF1,0x18,0xC7,0xA6,0xD8,0xA4,0x1A,
		0x6D,0xB9,0x86,0x91,0x18,0x99,0xCC,0x54,0x14,0xE7,
		0xE5,0x48,0xF3,0x03,0x3F,0x3A,0xB5,0x06,0xCF,0x0E,
		0xA6,0x43,0x3F,0x41,0x1D,0x73,0x5C,0x4D,0xD1,0x75,
		0x8C,0xE4,0x0F,0x84,0x7B,0x55,0xC1,0x06,0xDC,0xE4,
		0xB0,0xDE,0x07,0x5A,0xF1,0x0F,0xE0,0x58,0x92,0x81,
		0xB2,0x3D,0x7B,0x51,0x32,0x58,0x65,0x8F,0xB9,0x14,
		0x8D,0xA6,0xF5,0xC3,0x6D,0x4E,0xB6,0xFD,0x2A,0x23,
		0x31,0xF7,0xA2,0xEC,0x97,0x31,0x91,0xD8,0x98,0xDB,
		0x11,0xB6,0x2A,0xCF,0x18,0xE0,0xC7,0x49,0x00,0x89,
		0xAE,0x82,0xAD,0x29,0x77,0xB8,0xE6,0x02,0x80,0x26,
		0x4D,0x5A,0xB9,0xE1,0xF0,0xC2,0xE3,0x04,0x04,0x77,
		0xCF,0x53,0xBD,0x11,0x23,0xD2,0x8F,0x10,0xA4,0x80,
		0x60,0x8E,0x56,0xC8,0x3D,0xE8,0x9E,0x5B,0x84,0x03,
		0x76,0xD7,0xBF,0xC5,0xEF,0x40,0x73,0x28,0x30,0xEB,
		0xEA,0xA7,0x22,0x8E,0xEC,0x97,0x14,0xD7,0xFC,0xA3,
		0xF6,0xA5,0xD8,0x0D,0xE9,0xC4,0x3A,0x91,0x86,0x1E,
		0x75,0xFD,0x53,0xFB,0x17,0xAD,0x93,0x0B,0xAF,0x7B,
		0x6C,0x3D,0xF9,0x7F,0xDA,0x9D,0x66,0xD7,0x0D,0x6F,
		0x9A,0xF5,0xDF,0xFA,0xA8,0xE9,0xE6,0x60,0x79,0xD1,
		0x68,0xB3,0xC1,0x21,0xE5,0x0A,0x0E,0x0B,0xFE,0xA6,
		0xFE,0x0A,0xD8,0x49,0x98,0xF4,0xED,0x40,0xFF,0x00,
		0x85,0xF9,0x93,0xE5,0xD3,0xDA,0x29,0x1B,0x51,0x79,
		0x94,0x22,0x08,0xC4,0xE4,0x1C,0xD3,0x08,0x23,0xBD,
		0x5A,0x69,0x56,0x1B,0x47,0xF3,0xDB,0x35,0xFF,0xC4,
		0x00,0x29,0x11,0x00,0x02,0x01,0x03,0x03,0x03,0x03,
		0x04,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
		0x02,0x03,0x00,0x04,0x11,0x05,0x12,0x21,0x13,0x34,
		0x41,0x31,0x51,0x61,0x14,0x22,0x23,0x71,0x32,0xA1,
		0xC1,0xFF,0xDA,0x00,0x08,0x01,0x02,0x01,0x01,0x3F,
		0x00,0x94,0x4C,0x53,0x73,0x35,0x75,0x9E,0x78,0xB2,
		0x08,0xE2,0xAC,0xEC,0x5D,0x90,0x19,0x0F,0x14,0xFA,
		0x4C,0x65,0x4E,0xD3,0x83,0x5A,0x8D,0x93,0x5B,0x28,
		0xDC,0x73,0x5A,0x4F,0x6C,0xB5,0xAA,0x40,0xF7,0x23,
		0x7A,0x85,0x40,0x07,0xA0,0x1F,0xDD,0x5B,0x5A,0x49,
		0x1B,0xAE,0xE2,0x31,0x4D,0x73,0x92,0x42,0x78,0xA3,
		0x7C,0xF1,0xB7,0xE4,0x03,0x15,0xAD,0xC6,0xB2,0x41,
		0xBB,0xC8,0xE6,0xB4,0x8E,0xD5,0x68,0x0B,0x89,0xA3,
		0x65,0x2E,0x32,0x3E,0x2A,0xE2,0x39,0xA0,0x64,0xDE,
		0x73,0x91,0x4B,0xD4,0x50,0x00,0xA7,0x95,0xE4,0x42,
		0x5A,0xAE,0x6E,0x07,0xD1,0x94,0x3E,0xBF,0xE7,0x15,
		0xA4,0x76,0xAB,0x51,0x34,0x91,0x46,0x49,0x7E,0x31,
		0xED,0x53,0xC8,0xC1,0xD3,0x73,0x67,0x8A,0x53,0x2B,
		0x9C,0x83,0x41,0xE4,0x8F,0x2A,0x6A,0xF9,0x80,0x8F,
		0x27,0xD4,0xD6,0x91,0xDA,0x27,0xEA,0x89,0x63,0x11,
		0xCB,0x78,0xAB,0x4D,0x2E,0x7B,0xA2,0x87,0x71,0xC0,
		0x1C,0xFC,0x51,0x68,0xE3,0x25,0x3D,0x8F,0x9A,0x93,
		0xA5,0x9C,0x6E,0xC9,0x3E,0x07,0x35,0xAD,0x69,0xD2,
		0xA4,0x4B,0x28,0x1C,0x79,0xF8,0xAD,0x23,0xB4,0x4F,
		0xD5,0x59,0x69,0x50,0x5B,0x81,0x8E,0x4F,0xB9,0xA3,
		0x1B,0xC4,0xC4,0x81,0xF6,0xD5,0xFD,0x81,0x32,0x92,
		0x39,0xCF,0x35,0xA6,0xE9,0x89,0x6E,0xDD,0x46,0x19,
		0x6F,0x1F,0x14,0xA8,0x58,0xE0,0x8A,0x97,0x4F,0x51,
		0xFC,0x06,0x2B,0xFF,0xC4,0x00,0x29,0x11,0x00,0x02,
		0x01,0x03,0x02,0x05,0x04,0x02,0x03,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x01,0x02,0x03,0x00,0x04,0x11,
		0x05,0x21,0x12,0x22,0x31,0x41,0x71,0x13,0x34,0x51,
		0xA1,0x14,0x61,0x23,0x91,0xB1,0xFF,0xDA,0x00,0x08,
		0x01,0x03,0x01,0x01,0x3F,0x00,0x8A,0x1B,0x60,0xF8,
		0x55,0x34,0xE9,0x14,0x6E,0x46,0x0E,0xFF,0x00,0xBA,
		0xBA,0xBB,0x8D,0x5B,0x0A,0x37,0xA5,0xBD,0xC1,0xE6,
		0xAD,0x32,0xE0,0x49,0x29,0x00,0x76,0xAD,0x5B,0xDD,
		0x35,0x43,0x79,0x01,0x90,0x72,0x1C,0xF9,0xAB,0x89,
		0x62,0x64,0x6E,0x10,0x73,0x9A,0x4B,0x25,0x38,0x69,
		0x7B,0xD1,0xD2,0xE2,0x91,0x7F,0x89,0x8E,0x7F,0x75,
		0xA3,0x31,0x49,0xF8,0x4F,0x7D,0xAB,0x56,0xF7,0x4D,
		0x46,0x7B,0x68,0xE5,0x04,0x46,0x7F,0xBA,0x86,0x48,
		0x6E,0x11,0xB8,0x06,0x30,0x69,0x92,0x16,0x05,0x89,
		0xFB,0xA5,0xB7,0x48,0xC8,0xE1,0x3F,0x75,0x0C,0x07,
		0xF2,0x84,0xA3,0xA7,0x7F,0x35,0xAA,0x9C,0xDC,0xB1,
		0xA6,0xF4,0x24,0x90,0x0F,0x4F,0x7C,0xFC,0xD2,0x04,
		0xE1,0x60,0xAB,0x8D,0xE9,0x62,0x84,0x26,0xE3,0x6F,
		0xBA,0x9A,0x18,0xD8,0x06,0x03,0x15,0x67,0xCC,0xDC,
		0x1D,0x86,0xF5,0xAB,0x0C,0x5D,0x30,0xA1,0x16,0x24,
		0x04,0x27,0x7A,0x9E,0x74,0x8C,0x37,0x2E,0xF9,0xA8,
		0xC4,0x8C,0x15,0xFE,0x40,0xE9,0x41,0xA5,0x6D,0xF1,
		0x80,0x3B,0x9D,0xAB,0x4B,0xB8,0x42,0xEC,0x0F,0x53,
		0xD3,0xC5,0x6A,0xFE,0xE9,0xFC,0xD4,0xB7,0x4D,0x21,
		0xA9,0x24,0x70,0xE4,0xB7,0x4A,0xB4,0xBE,0xE1,0x88,
		0x60,0xE3,0x15,0x7D,0xAB,0x35,0xC0,0xF4,0xD3,0xA7,
		0xFB,0x51,0xDC,0x2B,0x8C,0x11,0x83,0x52,0x44,0x25,
	0xDC,0x9D,0xEB,0xFF,0xD9};
	
	DDRD |= (1<<PD0); // Set LED pin output
	DDRD |= (1<<PD1); // Set LED pin output
	PORTD &= ~(1<<PD0); // Turn LED off
	PORTD &= ~(1<<PD1); // Turn LED off
	
	/*// reboot delay
	_delay_ms(200);
	
	// init sdcard
	UINT bw;
	f_mount(0, &FatFs);		// Give a work area to the FatFs module 
	// open file
	fp = (FIL *)malloc(sizeof (FIL));
	if (f_open(fp, "file.txt", FA_WRITE | FA_CREATE_ALWAYS) == FR_OK) {	// Create a file // THREEDO: Change from text
		char *text = "Hello World! SDCard support up and running!\r\n";
		f_write(fp, text, strlen(text), &bw);	// Write data to the file 
		f_close(fp); // Close the file 
		if (bw == strlen(text)) { // We wrote the entire string
			PORTD |= (1<<PD0); // Turn LED on
		}
		//else led2.Set(1); //TODO: Fix
	}
	// test append
	if (f_open(fp, "file.txt", FA_WRITE | FA_OPEN_ALWAYS) == FR_OK) {	// Open existing or create new file
		if (f_lseek(fp, f_size(fp)) == FR_OK) 
			{
			char *text2 = "This is a new line, appended to existing file!\r\n";
			f_write(fp, text2, strlen(text2), &bw);	// Write data to the file
			if (bw == strlen(text2)) { //we wrote the entire string
				PORTD |= (1<<PD1); // Turn LED on
			}
			
		}	
		f_close(fp);// Close the file		
	}	*/
	//------------------------------------------
	// Image test
	
	// reboot delay
	_delay_ms(200);
	
	// init sdcard
	UINT bw;
	f_mount(0, &FatFs);		// Give a work area to the FatFs module
	// open file
	fp = (FIL *)malloc(sizeof (FIL));
	if (f_open(fp, "image.jpg", FA_WRITE | FA_CREATE_ALWAYS) == FR_OK) {	// Create a file
		f_write(fp, image, sizeof(image), &bw);	// Write data to the file
		f_close(fp); // Close the file
		if (bw ==  sizeof(image)) { // We wrote the entire string
			PORTD |= (1<<PD0); // Turn LED on
		}
		//else led2.Set(1); //TODO: Fix
	}
	
	
	
	//-----------------------------------------------
	 // char str[12];

	/*
	// get card volume
	char szCardLabel[12] = {0};
	DWORD sn = 0;
	if (f_getlabel("", szCardLabel, &sn) == FR_OK) {
		lcd.send_format_string("%s SN:%X\n", szCardLabel, sn);
	}			
	*/

	/*
	// read from file
	if (f_open(fp, "file.txt", FA_READ ) == FR_OK) {	// Create a file
		char text[255]; 
		UINT br;
		f_read(fp, text, 255, &br); 
		f_close(fp);// Close the file
		// cut text the easy way
		text[10] = 0;
		lcd.send_format_string("Read:%s", text);
	}	
	*/
	
	// loop
	while(1)
	{
	}
}